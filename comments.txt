Егор, привет!

исправил проект, убрал лишнее, добавил нужное. 
остались вопросы: 
1. не разобрался как количество и список можно получить в одну группировку, если передать две агрегатные функции в метод agg. уже изрядно подтупливаю, своей соображалки уже не хватает, а примеров найти не смог. буду рад, если ты поделишься советом как это сделать. надеюсь, что в будущем это мне пригодится. 
2. функцию расчёта дистанции оставил как есть. всё что в ней - из библиотеки math. нашёл и другие варианты, но там либо засады с TypeError: col should be Column, либо код делает тоже самое, что и у меня, но структура его - ужос ужасный. если ты не против, я оставлю функцию, как есть.

