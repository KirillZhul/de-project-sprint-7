Егор, привет!

исправил проект, убрал лишнее, добавил нужное. посмотри, пожалуйста..
нюансы:
1. функцию расчёта дистанции оставил как есть. всё что в ней - из библиотеки math. нашёл и другие варианты, но там либо засады с TypeError: col should be Column, либо код делает тоже самое, что и у меня, но структура его - ужос ужасный. если ты не против, я оставлю функцию, как есть.
2. я конечно изменил работы спарка в скриптах с локал на ярн. однако, проверяя работоспособность кода (испраления в проекте) в блокноте Юпитера, конечно работать спарком через ярн не возможно. ява сыпет ошибками.  
